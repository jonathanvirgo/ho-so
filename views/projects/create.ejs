<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('../layout/head') %>
    <title>Tạo Dự án Mới - Hệ thống Khảo sát</title>

    <!-- Custom styles for survey system -->
    <link href="/css/survey-system.css" rel="stylesheet">
</head>

<body>

    <!-- Page Wrapper -->
    <div id="wrapper">

        <!-- Sidebar -->
        <%- include('../layout/sidebar') %>

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">

            <!-- Main Content -->
            <div id="content">

                <!-- Header -->
                <%- include('../layout/header') %>

                <!-- Begin Page Content -->
                <div class="container-fluid">

                    <!-- Page Heading -->
                    <div class="d-sm-flex align-items-center justify-content-between mb-4">
                        <h1 class="h3 mb-0 text-gray-800">Tạo Dự án Mới</h1>
                        <a href="/projects" class="d-none d-sm-inline-block btn btn-sm btn-secondary shadow-sm">
                            <i class="fas fa-arrow-left fa-sm text-white-50"></i> Quay lại
                        </a>
                    </div>

                    <!-- Content Row -->
                    <div class="row justify-content-center">
                        <div class="col-xl-8 col-lg-10">
                            <!-- Project Form Card -->
                            <div class="card shadow mb-4">
                                <div class="card-header py-3">
                                    <h6 class="m-0 font-weight-bold text-primary">Thông tin Dự án</h6>
                                </div>
                                <div class="card-body">
                                    <form id="project-form">
                                        <div class="form-group">
                                            <label for="project-name">Tên Dự án <span class="text-danger">*</span></label>
                                            <input type="text" class="form-control" id="project-name" name="name" 
                                                   placeholder="Nhập tên dự án" required>
                                            <small class="form-text text-muted">Tên dự án sẽ được sử dụng để tạo Google Sheet</small>
                                        </div>

                                        <div class="form-group">
                                            <label for="project-description">Mô tả Dự án</label>
                                            <textarea class="form-control" id="project-description" name="description" 
                                                      rows="4" placeholder="Nhập mô tả chi tiết về dự án"></textarea>
                                        </div>

                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="project-start-date">Ngày Bắt đầu</label>
                                                    <input type="date" class="form-control" id="project-start-date" name="start_date">
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="project-end-date">Ngày Kết thúc</label>
                                                    <input type="date" class="form-control" id="project-end-date" name="end_date">
                                                </div>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label for="project-status">Trạng thái</label>
                                            <select class="form-control" id="project-status" name="active">
                                                <option value="1">Hoạt động</option>
                                                <option value="0">Tạm dừng</option>
                                            </select>
                                        </div>

                                        <hr>

                                        <div class="alert alert-info">
                                            <i class="fas fa-info-circle"></i>
                                            <strong>Lưu ý:</strong> Sau khi tạo dự án thành công, hệ thống sẽ tự động tạo một Google Sheet 
                                            để lưu trữ dữ liệu khảo sát. Bạn có thể cấu hình các khảo sát cho dự án này sau đó.
                                        </div>

                                        <div class="form-group text-right">
                                            <button type="button" class="btn btn-secondary" onclick="window.history.back()">
                                                <i class="fas fa-times"></i> Hủy
                                            </button>
                                            <button type="submit" class="btn btn-primary">
                                                <i class="fas fa-save"></i> Tạo Dự án
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <!-- /.container-fluid -->

            </div>
            <!-- End of Main Content -->

            <!-- Footer -->
            <%- include('../layout/footer') %>

        </div>
        <!-- End of Content Wrapper -->

    </div>
    <!-- End of Page Wrapper -->

    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
        <i class="fas fa-angle-up"></i>
    </a>

    <!-- Survey System JS -->
    <script src="/js/survey-system.js?v=<%= assetVersion %>"></script>

    <script>
        $(document).ready(function() {
            // Initialize date pickers
            flatpickr("#project-start-date", {
                dateFormat: "Y-m-d",
                locale: "vn"
            });

            flatpickr("#project-end-date", {
                dateFormat: "Y-m-d",
                locale: "vn"
            });

            // Validate end date is after start date
            $('#project-end-date').on('change', function() {
                const startDate = $('#project-start-date').val();
                const endDate = $(this).val();

                if (startDate && endDate && new Date(endDate) < new Date(startDate)) {
                    Swal.fire({
                        icon: 'warning',
                        title: 'Cảnh báo!',
                        text: 'Ngày kết thúc phải sau ngày bắt đầu'
                    });
                    $(this).val('');
                }
            });
        });
    </script>

</body>

</html>
